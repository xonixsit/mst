import{Q as j,l as x,b as C,w as v,a as e,c as m,f as b,o as c,F as S,r as N,p as y,u as l,d as w,t as i,g as $,h as D,v as M,N as _}from"./app-CMgtX0Ej.js";import{_ as B}from"./AppLayout-DGhDCHeo.js";import{r as F}from"./UserIcon-BQzPn_s2.js";import{r as V}from"./ArrowLeftIcon-BS0jr5Xh.js";const E={class:"flex items-center justify-between"},P={class:"flex items-center space-x-4"},T={class:"text-2xl font-bold text-gray-900"},z={class:"mt-1 text-sm text-gray-600"},A={class:"text-sm text-gray-500"},L={class:"flex items-center space-x-3"},q={class:"max-w-4xl mx-auto"},O={class:"space-y-4"},Q={class:"px-6 py-4 border-b border-gray-200"},Y={class:"flex items-center justify-between"},G={class:"flex items-center space-x-4"},H={class:"text-sm font-medium text-gray-900"},I={class:"text-sm text-gray-500"},J={class:"flex items-center space-x-2"},K={key:0},W={class:"px-6 py-6"},X={class:"text-sm font-medium text-gray-900 mb-2"},Z={class:"prose max-w-none"},ee={class:"whitespace-pre-wrap text-gray-700"},te={key:0,class:"px-6 py-3 bg-gray-50 border-t border-gray-200"},se={class:"text-xs text-gray-500"},re={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ae={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ie={class:"mt-3"},ne=["value"],oe=["value"],le={class:"flex justify-end space-x-3 pt-4"},de=["disabled"],ge={__name:"Show",props:{message:Object,conversation:Array},setup(r){const n=r,d=j(),p=x(!1),g=x(!1),u=x({body:""}),k=()=>{var a;if(!u.value.body||!u.value.body.trim()){alert("Please enter a reply message");return}g.value=!0,_.post(`/admin/messages/${n.message.id}/reply`,{body:u.value.body.trim(),client_id:(a=n.message.client)==null?void 0:a.id},{onSuccess:()=>{f(),_.reload()},onError:t=>{alert("Error sending reply: "+(t.error||"Unknown error"))},onFinish:()=>{g.value=!1}})},f=()=>{p.value=!1,u.value={body:""}},R=()=>n.message.sender_id===n.message.recipient_id?o(n.message.sender):n.message.sender_id===d.props.auth.user.id?o(n.message.recipient):o(n.message.sender),o=a=>{if(!a)return"Unknown User";if(a.name)return a.name;const t=[];return a.first_name&&t.push(a.first_name),a.last_name&&t.push(a.last_name),t.length>0?t.join(" "):a.email?a.email:"Unknown User"},h=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(a,t)=>(c(),C(B,null,{header:v(()=>{var s;return[e("div",E,[e("div",P,[e("button",{onClick:t[0]||(t[0]=U=>a.$inertia.visit("/admin/messages")),class:"text-gray-500 hover:text-gray-700"},[w(l(V),{class:"w-5 h-5"})]),e("div",null,[e("h1",T,i(r.message.subject),1),e("p",z,i(r.message.sender_id===l(d).props.auth.user.id?o(r.message.recipient):o(r.message.sender)),1),e("p",A," Client: "+i((s=r.message.client)!=null&&s.user?o(r.message.client.user):"Unknown Client"),1)])]),e("div",L,[e("span",{class:y([{"bg-red-100 text-red-800":r.message.priority==="high","bg-yellow-100 text-yellow-800":r.message.priority==="normal","bg-gray-100 text-gray-800":r.message.priority==="low"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},i(r.message.priority.charAt(0).toUpperCase()+r.message.priority.slice(1))+" Priority ",3),e("button",{onClick:t[1]||(t[1]=U=>p.value=!0),class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," Reply ")])])]}),default:v(()=>[e("div",q,[e("div",O,[(c(!0),m(S,null,N(r.conversation||[r.message],s=>(c(),m("div",{key:s.id,class:y(["bg-white shadow rounded-lg",{"ring-2 ring-blue-500":s.id===r.message.id}])},[e("div",Q,[e("div",Y,[e("div",G,[e("div",{class:y(["w-10 h-10 rounded-full flex items-center justify-center",s.sender_id===l(d).props.auth.user.id?"bg-blue-100":"bg-purple-100"])},[w(l(F),{class:y(["w-6 h-6",s.sender_id===l(d).props.auth.user.id?"text-blue-600":"text-purple-600"])},null,8,["class"])],2),e("div",null,[e("h3",H,i(s.sender_id===l(d).props.auth.user.id?"You":o(s.sender)),1),e("p",I,i(h(s.created_at)),1)])]),e("div",J,[!s.is_read&&s.recipient_id===l(d).props.auth.user.id?(c(),m("div",K,[...t[3]||(t[3]=[e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," Unread ",-1)])])):b("",!0),e("span",{class:y([{"bg-red-100 text-red-800":s.priority==="high","bg-yellow-100 text-yellow-800":s.priority==="normal","bg-gray-100 text-gray-800":s.priority==="low"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},i(s.priority),3)])])]),e("div",W,[e("h4",X,i(s.subject),1),e("div",Z,[e("p",ee,i(s.body),1)])]),s.read_at?(c(),m("div",te,[e("p",se," Read on "+i(h(s.read_at)),1)])):b("",!0)],2))),128))])]),p.value?(c(),m("div",re,[e("div",ae,[e("div",ie,[t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Reply to Message",-1)),e("form",{onSubmit:$(k,["prevent"]),class:"space-y-4"},[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),e("input",{value:R(),type:"text",class:"w-full border-gray-300 rounded-md shadow-sm bg-gray-50",disabled:""},null,8,ne)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subject",-1)),e("input",{value:"Re: "+r.message.subject,type:"text",class:"w-full border-gray-300 rounded-md shadow-sm bg-gray-50",disabled:""},null,8,oe)]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reply",-1)),D(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>u.value.body=s),rows:"5",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",maxlength:"2000",required:"",placeholder:"Type your reply here..."},null,512),[[M,u.value.body]])]),e("div",le,[e("button",{type:"button",onClick:f,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"}," Cancel "),e("button",{type:"submit",disabled:g.value,class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50"},i(g.value?"Sending...":"Send Reply"),9,de)])],32)])])])):b("",!0)]),_:1}))}};export{ge as default};
