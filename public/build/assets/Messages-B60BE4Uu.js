import{c as l,a as e,o as i,l as y,q as B,b as D,w as M,f as g,h as c,j as f,t as n,d as h,u as w,F as k,r as _,p as C,g as j,v as S,e as T,N as m}from"./app-Dpla5MbZ.js";import{_ as L}from"./AppLayout-CNJ2SeGy.js";import{r as R}from"./ChatBubbleLeftRightIcon-CyagJyav.js";import{r as z}from"./UserIcon-CZBTRvTc.js";function H(r,p){return i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}const O={class:"flex items-center justify-between"},E={class:"mt-1 text-sm text-gray-600"},G={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},I={class:"space-y-6"},J={class:"bg-white shadow rounded-lg p-6"},K={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Q={class:"bg-white shadow rounded-lg"},W={class:"px-6 py-4 border-b border-gray-200"},X={class:"text-lg font-medium text-gray-900"},Y={key:0,class:"p-6 text-center"},Z={key:1,class:"divide-y divide-gray-200"},ee=["onClick"],te={class:"flex items-start justify-between"},se={class:"flex items-start space-x-4"},oe={class:"flex-shrink-0"},ie={class:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center"},re={class:"flex-1 min-w-0"},ne={class:"flex items-center space-x-2"},le={class:"text-sm font-medium text-gray-900 truncate"},ae={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},de={class:"mt-1 flex items-center space-x-4 text-sm text-gray-500"},ue={class:"mt-1 text-sm text-gray-600 line-clamp-2"},ce={class:"flex items-center space-x-2"},ge=["onClick"],me={key:2,class:"px-6 py-4 border-t border-gray-200"},pe={class:"flex items-center justify-between"},xe={class:"text-sm text-gray-700"},ye={class:"flex space-x-2"},fe=["onClick"],ve={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},be={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},he={class:"mt-3"},we=["value"],ke={class:"flex justify-end space-x-3 pt-4"},_e=["disabled"],Se={__name:"Messages",props:{messages:Object,filters:Object,taxProfessionals:Array,unreadCount:Number},setup(r){const p=r,v=y(!1),x=y(!1),d=y({...p.filters}),a=y({recipient_id:"",subject:"",body:"",priority:"normal"}),N=B(()=>{const o=[],s=p.messages.current_page,t=p.messages.last_page;for(let u=Math.max(1,s-2);u<=Math.min(t,s+2);u++)o.push(u);return o}),U=()=>{x.value=!0,m.post("/client/messages",a.value,{onSuccess:()=>{$()},onFinish:()=>{x.value=!1}})},$=()=>{v.value=!1,a.value={recipient_id:"",subject:"",body:"",priority:"normal"}},V=o=>{m.get(`/client/messages/${o.id}`)},F=o=>{m.patch(`/client/messages/${o.id}/read`)},b=()=>{m.get("/client/messages",d.value,{preserveState:!0,replace:!0})},P=()=>{d.value={status:"",priority:""},b()},q=o=>{m.get("/client/messages",{...d.value,page:o},{preserveState:!0,replace:!0})},A=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(o,s)=>(i(),D(L,null,{header:M(()=>[e("div",O,[e("div",null,[s[8]||(s[8]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Messages",-1)),e("p",E,[s[7]||(s[7]=T(" Communicate with your tax professional ",-1)),r.unreadCount>0?(i(),l("span",G,n(r.unreadCount)+" unread ",1)):g("",!0)])]),e("button",{onClick:s[0]||(s[0]=t=>v.value=!0),class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," New Message ")])]),default:M(()=>[e("div",I,[e("div",J,[e("div",K,[e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),c(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>d.value.status=t),onChange:b,class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},[...s[9]||(s[9]=[e("option",{value:""},"All Messages",-1),e("option",{value:"unread"},"Unread",-1),e("option",{value:"read"},"Read",-1)])],544),[[f,d.value.status]])]),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),c(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.priority=t),onChange:b,class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},[...s[11]||(s[11]=[e("option",{value:""},"All Priorities",-1),e("option",{value:"high"},"High",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"low"},"Low",-1)])],544),[[f,d.value.priority]])]),e("div",{class:"flex items-end"},[e("button",{onClick:P,class:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Clear Filters ")])])]),e("div",Q,[e("div",W,[e("h2",X," Messages ("+n(r.messages.total)+") ",1)]),r.messages.data.length===0?(i(),l("div",Y,[h(w(R),{class:"mx-auto w-12 h-12 text-gray-400"}),s[13]||(s[13]=e("p",{class:"mt-2 text-gray-600"},"No messages found.",-1)),s[14]||(s[14]=e("p",{class:"text-sm text-gray-500"},"Start a conversation with your tax professional.",-1))])):(i(),l("div",Z,[(i(!0),l(k,null,_(r.messages.data,t=>(i(),l("div",{key:t.id,class:C([{"bg-blue-50":!t.is_read&&t.recipient_id===o.$page.props.auth.user.id},"p-6 hover:bg-gray-50 cursor-pointer"]),onClick:u=>V(t)},[e("div",te,[e("div",se,[e("div",oe,[e("div",ie,[h(w(z),{class:"w-6 h-6 text-purple-600"})])]),e("div",re,[e("div",ne,[e("h3",le,n(t.subject),1),!t.is_read&&t.recipient_id===o.$page.props.auth.user.id?(i(),l("span",ae," New ")):g("",!0),e("span",{class:C([{"bg-red-100 text-red-800":t.priority==="high","bg-yellow-100 text-yellow-800":t.priority==="normal","bg-gray-100 text-gray-800":t.priority==="low"},"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"])},n(t.priority.charAt(0).toUpperCase()+t.priority.slice(1)),3)]),e("div",de,[e("span",null,n(t.sender_id===o.$page.props.auth.user.id?"To":"From")+": "+n(t.sender_id===o.$page.props.auth.user.id?t.recipient?`${t.recipient.first_name} ${t.recipient.last_name}`:"Unknown":t.sender?`${t.sender.first_name} ${t.sender.last_name}`:"Unknown"),1),e("span",null,n(A(t.created_at)),1)]),e("p",ue,n(t.body),1)])]),e("div",ce,[!t.is_read&&t.recipient_id===o.$page.props.auth.user.id?(i(),l("button",{key:0,onClick:j(u=>F(t),["stop"]),class:"text-indigo-600 hover:text-indigo-500 text-sm font-medium"}," Mark Read ",8,ge)):g("",!0),h(w(H),{class:"w-5 h-5 text-gray-400"})])])],10,ee))),128))])),r.messages.last_page>1?(i(),l("div",me,[e("div",pe,[e("div",xe," Showing "+n(r.messages.from)+" to "+n(r.messages.to)+" of "+n(r.messages.total)+" results ",1),e("div",ye,[(i(!0),l(k,null,_(N.value,t=>(i(),l("button",{key:t,onClick:u=>q(t),class:C([{"bg-indigo-600 text-white":t===r.messages.current_page,"bg-white text-gray-700 hover:bg-gray-50":t!==r.messages.current_page},"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium"])},n(t),11,fe))),128))])])])):g("",!0)])]),v.value?(i(),l("div",ve,[e("div",be,[e("div",he,[s[21]||(s[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"New Message",-1)),e("form",{onSubmit:j(U,["prevent"]),class:"space-y-4"},[e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),c(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>a.value.recipient_id=t),class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},[s[15]||(s[15]=e("option",{value:""},"Select recipient",-1)),(i(!0),l(k,null,_(r.taxProfessionals,t=>(i(),l("option",{key:t.id,value:t.id},n(`${t.first_name} ${t.last_name}`),9,we))),128))],512),[[f,a.value.recipient_id]])]),e("div",null,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subject",-1)),c(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>a.value.subject=t),type:"text",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[S,a.value.subject]])]),e("div",null,[s[19]||(s[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),c(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>a.value.priority=t),class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},[...s[18]||(s[18]=[e("option",{value:"low"},"Low",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"high"},"High",-1)])],512),[[f,a.value.priority]])]),e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Message",-1)),c(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=t=>a.value.body=t),rows:"5",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",maxlength:"2000",required:""},null,512),[[S,a.value.body]])]),e("div",ke,[e("button",{type:"button",onClick:$,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"}," Cancel "),e("button",{type:"submit",disabled:x.value,class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50"},n(x.value?"Sending...":"Send Message"),9,_e)])],32)])])])):g("",!0)]),_:1}))}};export{Se as default};
