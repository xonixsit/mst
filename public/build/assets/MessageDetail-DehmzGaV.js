import{Q as j,l as x,b as U,w as v,a as e,c as m,f as b,o as u,F as S,r as C,p as g,u as l,d as w,t as r,g as N,h as $,v as D,N as _}from"./app-BWB3rdom.js";import{_ as M}from"./AppLayout-BJNZDLSI.js";import{r as B}from"./UserIcon-B7y7Xt8h.js";import{r as F}from"./ArrowLeftIcon-BiU8vdyw.js";const V={class:"flex items-center justify-between"},z={class:"flex items-center space-x-4"},A={class:"text-2xl font-bold text-gray-900"},E={class:"mt-1 text-sm text-gray-600"},L={class:"flex items-center space-x-3"},P={class:"max-w-4xl mx-auto"},T={class:"space-y-4"},q={class:"px-6 py-4 border-b border-gray-200"},I={class:"flex items-center justify-between"},O={class:"flex items-center space-x-4"},Q={class:"text-sm font-medium text-gray-900"},Y={class:"text-sm text-gray-500"},G={class:"flex items-center space-x-2"},H={key:0},J={class:"px-6 py-6"},K={class:"text-sm font-medium text-gray-900 mb-2"},W={class:"prose max-w-none"},X={class:"whitespace-pre-wrap text-gray-700"},Z={key:0,class:"px-6 py-3 bg-gray-50 border-t border-gray-200"},ee={class:"text-xs text-gray-500"},te={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},se={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ae={class:"mt-3"},ie=["value"],re=["value"],oe={class:"flex justify-end space-x-3 pt-4"},ne=["disabled"],me={__name:"MessageDetail",props:{message:Object,conversation:Array},setup(i){const o=i,n=j(),p=x(!1),y=x(!1),c=x({body:""}),k=()=>{y.value=!0,console.log("Sending reply:",{url:`/client/messages/${o.message.id}/reply`,data:c.value,messageId:o.message.id,currentUser:n.props.auth.user}),_.post(`/client/messages/${o.message.id}/reply`,c.value,{onSuccess:a=>{console.log("Reply successful"),f(),_.reload()},onError:a=>{console.log("Reply errors:",a)},onFinish:()=>{y.value=!1}})},f=()=>{p.value=!1,c.value={body:""}},R=()=>o.message.sender_id===o.message.recipient_id?d(o.message.sender):o.message.sender_id===n.props.auth.user.id?d(o.message.recipient):d(o.message.sender),d=a=>{if(!a)return"Unknown User";if(a.name)return a.name;const t=[];return a.first_name&&t.push(a.first_name),a.last_name&&t.push(a.last_name),t.length>0?t.join(" "):a.email?a.email:"Unknown User"},h=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(a,t)=>(u(),U(M,null,{header:v(()=>[e("div",V,[e("div",z,[e("button",{onClick:t[0]||(t[0]=s=>a.$inertia.visit("/client/messages")),class:"text-gray-500 hover:text-gray-700"},[w(l(F),{class:"w-5 h-5"})]),e("div",null,[e("h1",A,r(i.message.subject),1),e("p",E,r(i.message.sender_id===l(n).props.auth.user.id?d(i.message.recipient):d(i.message.sender)),1)])]),e("div",L,[e("span",{class:g([{"bg-red-100 text-red-800":i.message.priority==="high","bg-yellow-100 text-yellow-800":i.message.priority==="normal","bg-gray-100 text-gray-800":i.message.priority==="low"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(i.message.priority.charAt(0).toUpperCase()+i.message.priority.slice(1))+" Priority ",3),e("button",{onClick:t[1]||(t[1]=s=>p.value=!0),class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," Reply ")])])]),default:v(()=>[e("div",P,[e("div",T,[(u(!0),m(S,null,C(i.conversation||[i.message],s=>(u(),m("div",{key:s.id,class:g(["bg-white shadow rounded-lg",{"ring-2 ring-blue-500":s.id===i.message.id}])},[e("div",q,[e("div",I,[e("div",O,[e("div",{class:g(["w-10 h-10 rounded-full flex items-center justify-center",s.sender_id===l(n).props.auth.user.id?"bg-blue-100":"bg-purple-100"])},[w(l(B),{class:g(["w-6 h-6",s.sender_id===l(n).props.auth.user.id?"text-blue-600":"text-purple-600"])},null,8,["class"])],2),e("div",null,[e("h3",Q,r(s.sender_id===l(n).props.auth.user.id?"You":d(s.sender)),1),e("p",Y,r(h(s.created_at)),1)])]),e("div",G,[!s.is_read&&s.recipient_id===l(n).props.auth.user.id?(u(),m("div",H,[...t[3]||(t[3]=[e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," Unread ",-1)])])):b("",!0),e("span",{class:g([{"bg-red-100 text-red-800":s.priority==="high","bg-yellow-100 text-yellow-800":s.priority==="normal","bg-gray-100 text-gray-800":s.priority==="low"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(s.priority),3)])])]),e("div",J,[e("h4",K,r(s.subject),1),e("div",W,[e("p",X,r(s.body),1)])]),s.read_at?(u(),m("div",Z,[e("p",ee," Read on "+r(h(s.read_at)),1)])):b("",!0)],2))),128))])]),p.value?(u(),m("div",te,[e("div",se,[e("div",ae,[t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Reply to Message",-1)),e("form",{onSubmit:N(k,["prevent"]),class:"space-y-4"},[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),e("input",{value:R(),type:"text",class:"w-full border-gray-300 rounded-md shadow-sm bg-gray-50",disabled:""},null,8,ie)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subject",-1)),e("input",{value:"Re: "+i.message.subject,type:"text",class:"w-full border-gray-300 rounded-md shadow-sm bg-gray-50",disabled:""},null,8,re)]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reply",-1)),$(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>c.value.body=s),rows:"5",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",maxlength:"2000",required:""},null,512),[[D,c.value.body]])]),e("div",oe,[e("button",{type:"button",onClick:f,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"}," Cancel "),e("button",{type:"submit",disabled:y.value,class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50"},r(y.value?"Sending...":"Send Reply"),9,ne)])],32)])])])):b("",!0)]),_:1}))}};export{me as default};
