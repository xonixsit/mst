import{l as y,m as j,b as R,w as b,a as e,c as l,f as u,d as B,e as f,u as S,i as M,g as D,o,t as i,h,A as z,F as g,r as x,j as N,p as F}from"./app-Dpla5MbZ.js";import{_ as O}from"./AppLayout-CNJ2SeGy.js";const P={class:"py-12"},q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},$={class:"p-6 lg:p-8"},X={class:"flex items-center justify-between mb-8"},Y={class:"flex space-x-3"},G={class:"bg-gray-50 rounded-lg p-6 mb-8"},J={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400 transition-colors"},Q={class:"space-y-1 text-center"},W={class:"flex text-sm text-gray-600"},Z={for:"csv-file",class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},ee={key:0,class:"mt-3 p-3 bg-blue-50 rounded-md"},te={class:"flex items-center"},se={class:"text-sm text-blue-700 font-medium"},oe={class:"text-sm text-blue-600 ml-2"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={class:"space-y-3"},re={class:"flex items-center"},ne={class:"flex items-center"},ae=["value"],de={class:"flex justify-end space-x-3"},ue=["disabled"],ce={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24"},pe=["disabled"],me={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},ge={key:0,class:"bg-white border border-gray-200 rounded-lg p-6 mb-8"},xe={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},ve={class:"bg-blue-50 p-4 rounded-lg"},fe={class:"text-2xl font-bold text-blue-600"},ye={class:"bg-green-50 p-4 rounded-lg"},be={class:"text-2xl font-bold text-green-600"},he={class:"bg-red-50 p-4 rounded-lg"},we={class:"text-2xl font-bold text-red-600"},_e={class:"bg-yellow-50 p-4 rounded-lg"},ke={class:"text-2xl font-bold text-yellow-600"},Ce={key:0,class:"overflow-x-auto"},Ie={class:"min-w-full divide-y divide-gray-200"},Ve={class:"bg-white divide-y divide-gray-200"},Be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Se={class:"px-6 py-4 whitespace-nowrap"},Me={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},ze={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ee={class:"px-6 py-4 text-sm text-red-600"},Le={key:0,class:"space-y-1"},Ae={key:0,class:"text-xs text-gray-500"},He={key:1,class:"mt-6"},je={class:"bg-red-50 border border-red-200 rounded-md p-4 max-h-40 overflow-y-auto"},Re={class:"text-sm text-red-700 space-y-1"},De={key:0,class:"text-red-500 font-medium"},Ne={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},Oe={class:"flex items-center mb-4"},Pe={key:0,class:"w-6 h-6 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},qe={key:1,class:"w-6 h-6 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},Ke={class:"text-gray-600 mb-4"},$e={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Xe={class:"bg-green-50 p-4 rounded-lg"},Ye={class:"text-2xl font-bold text-green-600"},Ge={class:"bg-yellow-50 p-4 rounded-lg"},Je={class:"text-2xl font-bold text-yellow-600"},Qe={class:"bg-red-50 p-4 rounded-lg"},We={class:"text-2xl font-bold text-red-600"},Ze={key:1,class:"mt-4"},et={class:"bg-red-50 border border-red-200 rounded-md p-4 max-h-40 overflow-y-auto"},tt={class:"text-sm text-red-700 space-y-1"},st={class:"mt-6 flex justify-end"},ot={class:"bg-gray-50 rounded-lg p-6 mt-8"},lt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 text-sm"},it={class:"font-mono bg-gray-200 px-2 py-1 rounded text-xs"},rt={key:0,class:"text-red-500 ml-1"},dt={__name:"Import",props:{availableUsers:Array,sampleHeaders:Array},setup(w){const c=y(null),p=y(!1),n=y(null),a=y(null),d=j({skipInvalid:!0,updateExisting:!1,assignToUser:""}),T=r=>{const t=r.target.files[0];t&&(c.value=t,n.value=null,a.value=null)},U=()=>{c.value=null,n.value=null,a.value=null,document.getElementById("csv-file")&&(document.getElementById("csv-file").value="")},E=r=>{if(r===0)return"0 Bytes";const t=1024,m=["Bytes","KB","MB","GB"],v=Math.floor(Math.log(r)/Math.log(t));return parseFloat((r/Math.pow(t,v)).toFixed(2))+" "+m[v]},L=()=>{window.location.href=route("admin.clients.download-csv-template")},A=async()=>{if(!c.value)return;p.value=!0,a.value=null;const r=new FormData;r.append("csv_file",c.value),r.append("preview","1"),r.append("skip_invalid",d.skipInvalid?"1":"0"),r.append("update_existing",d.updateExisting?"1":"0"),d.assignToUser&&r.append("assign_to_user",d.assignToUser);try{const m=await(await fetch(route("admin.clients.process-csv-import"),{method:"POST",body:r,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();n.value=m}catch(t){console.error("Preview failed:",t),n.value={success:!1,message:"Failed to preview import: "+t.message}}finally{p.value=!1}},H=async()=>{if(!c.value)return;p.value=!0,n.value=null;const r=new FormData;r.append("csv_file",c.value),r.append("skip_invalid",d.skipInvalid?"1":"0"),r.append("update_existing",d.updateExisting?"1":"0"),d.assignToUser&&r.append("assign_to_user",d.assignToUser);try{const m=await(await fetch(route("admin.clients.process-csv-import"),{method:"POST",body:r,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();a.value=m}catch(t){console.error("Import failed:",t),a.value={success:!1,message:"Import failed: "+t.message,imported:0,skipped:0,errors:[t.message]}}finally{p.value=!1}};return(r,t)=>(o(),R(O,{title:"Import Clients"},{default:b(()=>{var m,v,_,k,C;return[e("div",P,[e("div",q,[e("div",K,[e("div",$,[e("div",X,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-2xl font-medium text-gray-900"},"Import Clients from CSV"),e("p",{class:"mt-2 text-sm text-gray-600"}," Upload a CSV file to import multiple clients at once. You can preview the data before importing. ")],-1)),e("div",Y,[e("button",{onClick:L,class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150"},[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),f(" Download Template ",-1)])]),B(S(M),{href:r.route("admin.clients.index"),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:border-blue-300 focus:ring ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition ease-in-out duration-150"},{default:b(()=>[...t[4]||(t[4]=[f(" Back to Clients ",-1)])]),_:1},8,["href"])])]),e("div",G,[e("form",{onSubmit:D(H,["prevent"]),class:"space-y-6"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," CSV File ",-1)),e("div",J,[e("div",Q,[t[8]||(t[8]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",W,[e("label",Z,[t[6]||(t[6]=e("span",null,"Upload a CSV file",-1)),e("input",{id:"csv-file",ref:"fileInput",type:"file",accept:".csv,.txt",onChange:T,class:"sr-only"},null,544)]),t[7]||(t[7]=e("p",{class:"pl-1"},"or drag and drop",-1))]),t[9]||(t[9]=e("p",{class:"text-xs text-gray-500"},"CSV files up to 10MB",-1))])]),c.value?(o(),l("div",ee,[e("div",te,[t[11]||(t[11]=e("svg",{class:"w-5 h-5 text-blue-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})],-1)),e("span",se,i(c.value.name),1),e("span",oe,"("+i(E(c.value.size))+")",1),e("button",{type:"button",onClick:U,class:"ml-auto text-blue-400 hover:text-blue-600"},[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])])):u("",!0)]),e("div",le,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Import Options ",-1)),e("div",ie,[e("label",re,[h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.skipInvalid=s),type:"checkbox",class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[z,d.skipInvalid]]),t[13]||(t[13]=e("span",{class:"ml-2 text-sm text-gray-600"},"Skip invalid rows",-1))]),e("label",ne,[h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.updateExisting=s),type:"checkbox",class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[z,d.updateExisting]]),t[14]||(t[14]=e("span",{class:"ml-2 text-sm text-gray-600"},"Update existing clients",-1))])])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Assign to User (Optional) ",-1)),h(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.assignToUser=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[t[16]||(t[16]=e("option",{value:""},"No assignment",-1)),(o(!0),l(g,null,x(w.availableUsers,s=>(o(),l("option",{key:s.id,value:s.id},i(s.name)+" ("+i(s.email)+") ",9,ae))),128))],512),[[N,d.assignToUser]])])]),e("div",de,[e("button",{type:"button",onClick:A,disabled:!c.value||p.value,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:border-blue-300 focus:ring ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition ease-in-out duration-150"},[p.value?(o(),l("svg",ce,[...t[18]||(t[18]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):u("",!0),t[19]||(t[19]=f(" Preview Import ",-1))],8,ue),e("button",{type:"submit",disabled:!c.value||p.value,class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150"},[p.value?(o(),l("svg",me,[...t[20]||(t[20]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):u("",!0),t[21]||(t[21]=f(" Import Clients ",-1))],8,pe)])],32)]),n.value?(o(),l("div",ge,[t[28]||(t[28]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Import Preview",-1)),e("div",xe,[e("div",ve,[e("div",fe,i(n.value.total_rows),1),t[22]||(t[22]=e("div",{class:"text-sm text-blue-600"},"Total Rows",-1))]),e("div",ye,[e("div",be,i(n.value.valid_rows),1),t[23]||(t[23]=e("div",{class:"text-sm text-green-600"},"Valid Rows",-1))]),e("div",he,[e("div",we,i(n.value.invalid_rows),1),t[24]||(t[24]=e("div",{class:"text-sm text-red-600"},"Invalid Rows",-1))]),e("div",_e,[e("div",ke,i(((m=n.value.errors)==null?void 0:m.length)||0),1),t[25]||(t[25]=e("div",{class:"text-sm text-yellow-600"},"Total Errors",-1))])]),(v=n.value.preview_data)!=null&&v.length?(o(),l("div",Ce,[e("table",Ie,[t[26]||(t[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Row"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Issues")])],-1)),e("tbody",Ve,[(o(!0),l(g,null,x(n.value.preview_data,s=>{var I;return o(),l("tr",{key:s.row_number,class:F(s.is_valid?"bg-white":"bg-red-50")},[e("td",Be,i(s.row_number),1),e("td",Se,[s.is_valid?(o(),l("span",Me," Valid ")):(o(),l("span",ze," Invalid "))]),e("td",Fe,i(`${s.data.first_name||""} ${s.data.last_name||""}`.trim()),1),e("td",Te,i(s.data.email),1),e("td",Ue,i(s.data.phone),1),e("td",Ee,[(I=s.errors)!=null&&I.length?(o(),l("div",Le,[(o(!0),l(g,null,x(s.errors.slice(0,2),V=>(o(),l("div",{key:V,class:"text-xs"},i(V),1))),128)),s.errors.length>2?(o(),l("div",Ae,"+"+i(s.errors.length-2)+" more",1)):u("",!0)])):u("",!0)])],2)}),128))])])])):u("",!0),(_=n.value.errors)!=null&&_.length?(o(),l("div",He,[t[27]||(t[27]=e("h4",{class:"text-md font-medium text-red-900 mb-3"},"Import Errors",-1)),e("div",je,[e("ul",Re,[(o(!0),l(g,null,x(n.value.errors.slice(0,10),s=>(o(),l("li",{key:s},i(s),1))),128)),n.value.errors.length>10?(o(),l("li",De," ... and "+i(n.value.errors.length-10)+" more errors ",1)):u("",!0)])])])):u("",!0)])):u("",!0),a.value?(o(),l("div",Ne,[e("div",Oe,[a.value.success?(o(),l("svg",Pe,[...t[29]||(t[29]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])])):(o(),l("svg",qe,[...t[30]||(t[30]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])])),e("h3",{class:F(["text-lg font-medium",a.value.success?"text-green-900":"text-red-900"])}," Import "+i(a.value.success?"Completed":"Failed"),3)]),e("p",Ke,i(a.value.message),1),a.value.success?(o(),l("div",$e,[e("div",Xe,[e("div",Ye,i(a.value.imported),1),t[31]||(t[31]=e("div",{class:"text-sm text-green-600"},"Imported",-1))]),e("div",Ge,[e("div",Je,i(a.value.skipped),1),t[32]||(t[32]=e("div",{class:"text-sm text-yellow-600"},"Skipped",-1))]),e("div",Qe,[e("div",We,i(((k=a.value.errors)==null?void 0:k.length)||0),1),t[33]||(t[33]=e("div",{class:"text-sm text-red-600"},"Errors",-1))])])):u("",!0),(C=a.value.errors)!=null&&C.length?(o(),l("div",Ze,[t[34]||(t[34]=e("h4",{class:"text-md font-medium text-red-900 mb-3"},"Import Errors",-1)),e("div",et,[e("ul",tt,[(o(!0),l(g,null,x(a.value.errors,s=>(o(),l("li",{key:s},i(s),1))),128))])])])):u("",!0),e("div",st,[B(S(M),{href:r.route("admin.clients.index"),class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150"},{default:b(()=>[...t[35]||(t[35]=[f(" View Clients ",-1)])]),_:1},8,["href"])])])):u("",!0),e("div",ot,[t[36]||(t[36]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"CSV Format Requirements",-1)),t[37]||(t[37]=e("p",{class:"text-sm text-gray-600 mb-4"}," Your CSV file should include the following columns. Required columns are marked with an asterisk (*). ",-1)),e("div",lt,[(o(!0),l(g,null,x(w.sampleHeaders,s=>(o(),l("div",{key:s,class:"flex items-center"},[e("span",it,i(s),1),["first_name","last_name","email"].includes(s)?(o(),l("span",rt,"*")):u("",!0)]))),128))])])])])])])]}),_:1}))}};export{dt as default};
