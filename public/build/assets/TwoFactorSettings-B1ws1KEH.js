import{r as l,T as _,c as s,a as e,d as B,u as d,f as T,g as m,t as i,F,h as A,j as D,k as V,v as j,C as v,o as r}from"./app-BQNIn2f8.js";const E={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},S={class:"bg-gradient-to-r from-slate-50 to-gray-50 px-6 py-5 border-b border-gray-200"},M={class:"flex items-center justify-between"},N={key:0,class:"flex items-center space-x-2 px-3 py-1.5 rounded-full bg-green-100 border border-green-200"},R={key:1,class:"flex items-center space-x-2 px-3 py-1.5 rounded-full bg-gray-100 border border-gray-200"},Y={class:"px-6 py-6"},z={key:0,class:"space-y-4"},H=["href"],L={key:1,class:"space-y-6"},$={class:"border-t border-gray-200 pt-6"},G=["disabled"],I={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200"},O={class:"grid grid-cols-2 gap-2 font-mono text-sm mb-4"},U={class:"border-t border-gray-200 pt-6"},q=["disabled"],J={class:"border-t border-gray-200 pt-6"},K={key:0,class:"mt-4 p-4 bg-red-50 rounded-lg border border-red-200"},P={key:0,class:"text-sm text-red-600 mt-1"},Q={class:"flex gap-2"},W=["disabled"],Z={__name:"TwoFactorSettings",props:{user:Object},setup(x){const u=window.route,c=l([]),y=l(!1),b=l(!1),f=l(!1),g=l(!1),p=l(!1),a=_({password:""}),w=async()=>{b.value=!0;try{const t=await v.get(u("auth.2fa.backup-codes"));c.value=t.data.codes,y.value=!0}catch(t){console.error("Error loading backup codes:",t)}finally{b.value=!1}},h=()=>{const t=c.value.join(`
`);navigator.clipboard.writeText(t),f.value=!0,setTimeout(()=>{f.value=!1},2e3)},k=async()=>{if(confirm("Are you sure? Your old backup codes will no longer work.")){g.value=!0;try{const t=await v.post(u("auth.2fa.backup-codes.regenerate"),{password:prompt("Enter your password to confirm:")});c.value=t.data.codes,y.value=!0}catch(t){console.error("Error regenerating backup codes:",t)}finally{g.value=!1}}},C=()=>{a.post(u("auth.2fa.disable"),{onSuccess:()=>{p.value=!1,a.reset()}})};return(t,o)=>(r(),s("div",E,[e("div",S,[e("div",M,[o[5]||(o[5]=B('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div><div><h3 class="text-lg font-bold text-gray-900">Two-Factor Authentication</h3><p class="text-sm text-gray-600">Add an extra layer of security to your account</p></div></div>',1)),x.user.two_factor_enabled?(r(),s("div",N,[...o[3]||(o[3]=[e("span",{class:"w-2 h-2 bg-green-500 rounded-full"},null,-1),e("span",{class:"text-xs font-semibold text-green-800"},"Enabled",-1)])])):(r(),s("div",R,[...o[4]||(o[4]=[e("span",{class:"w-2 h-2 bg-gray-500 rounded-full"},null,-1),e("span",{class:"text-xs font-semibold text-gray-800"},"Disabled",-1)])]))])]),e("div",Y,[x.user.two_factor_enabled?(r(),s("div",L,[o[16]||(o[16]=e("div",{class:"p-4 bg-green-50 rounded-lg border border-green-200"},[e("p",{class:"text-sm text-green-900"},[e("strong",null,"✓ Two-factor authentication is enabled")]),e("p",{class:"text-sm text-green-800 mt-1"}," Your account is protected with an additional layer of security. ")],-1)),e("div",$,[o[8]||(o[8]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Backup Codes",-1)),o[9]||(o[9]=e("p",{class:"text-sm text-gray-600 mb-4"}," Save these codes in a safe place. You can use them to access your account if you lose your authenticator device. ",-1)),e("button",{onClick:w,disabled:b.value,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors disabled:opacity-50"},i(b.value?"Loading...":"View Backup Codes"),9,G),y.value?(r(),s("div",I,[e("div",O,[(r(!0),s(F,null,A(c.value,n=>(r(),s("div",{key:n,class:"p-2 bg-white rounded border border-gray-200"},i(n),1))),128))]),e("button",{onClick:h,class:"text-sm text-blue-600 hover:text-blue-800 font-medium"},i(f.value?"✓ Copied!":"Copy all codes"),1)])):m("",!0)]),e("div",U,[o[10]||(o[10]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Regenerate Backup Codes",-1)),o[11]||(o[11]=e("p",{class:"text-sm text-gray-600 mb-4"}," Generate new backup codes. Your old codes will no longer work. ",-1)),e("button",{onClick:k,disabled:g.value,class:"px-4 py-2 border border-amber-300 text-amber-700 rounded-lg font-semibold hover:bg-amber-50 transition-colors disabled:opacity-50"},i(g.value?"Regenerating...":"Regenerate Codes"),9,q)]),e("div",J,[o[14]||(o[14]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Disable 2FA",-1)),o[15]||(o[15]=e("p",{class:"text-sm text-gray-600 mb-4"}," Remove two-factor authentication from your account. ",-1)),e("button",{onClick:o[0]||(o[0]=n=>p.value=!0),class:"px-4 py-2 border border-red-300 text-red-700 rounded-lg font-semibold hover:bg-red-50 transition-colors"}," Disable 2FA "),p.value?(r(),s("div",K,[o[13]||(o[13]=e("p",{class:"text-sm text-red-900 font-medium mb-4"}," Are you sure? This will remove two-factor authentication from your account. ",-1)),e("form",{onSubmit:D(C,["prevent"]),class:"space-y-4"},[e("div",null,[o[12]||(o[12]=e("label",{class:"block text-sm font-semibold text-gray-900 mb-2"}," Enter your password to confirm: ",-1)),V(e("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>d(a).password=n),type:"password",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[j,d(a).password]]),d(a).errors.password?(r(),s("div",P,i(d(a).errors.password),1)):m("",!0)]),e("div",Q,[e("button",{type:"button",onClick:o[2]||(o[2]=n=>p.value=!1),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:d(a).processing,class:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-300 text-white rounded-lg font-semibold transition-colors"},i(d(a).processing?"Disabling...":"Disable 2FA"),9,W)])],32)])):m("",!0)])])):(r(),s("div",z,[o[7]||(o[7]=e("p",{class:"text-gray-600"}," Two-factor authentication adds an extra layer of security to your account. In addition to your password, you'll need to enter a code from your phone to sign in. ",-1)),e("a",{href:d(u)("auth.2fa.setup"),class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl"},[...o[6]||(o[6]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),T(" Enable 2FA ",-1)])],8,H)]))])]))}};export{Z as _};
